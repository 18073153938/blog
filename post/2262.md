Title: 重回 Ubuntu
Date: 2015-04-04 09:40:25
Modified: 2015-04-04 09:40:25
Author: zrong
Postid: 2262
Slug: 2262
Nicename: return-to-ubuntu
Category: technology
Tags: linux,ubuntu
Attachments: $ATTACHMENTS
Posttype: post
Poststatus: publish

2010年，我使用了半年的 ubuntu 系统，主要是用来办公，还写了一个 [抛弃 Windows ，用 Ubuntu 办公][1] 系列。经过这半年的测试，我认为，Ubuntu 已经完全可以满足办公的需求。

后来，我抛弃了 Office Boy 的工作，开始程序员生涯，重新用回了 Windows 。

接下来的2年多时间里，我主要使用 [cygwin][4] 和 [MinGW][3] 在 Windows 下工作。

2012年，由于从页游开发转向手游开发，我开始使用 Mac OS X 系统。OS X 与 Linux 同源，因此上手非常快。但由于及其讨厌 Finder 的垃圾设计，自己内心一直抵触使用 OS X 。

2013年，我的主要技术转向 [cocos2d-x][2] ，我不得不开始使用 XCode 和 Objective-C ，这样，就必须在 OS X 下工作了。

于是，在公司，我同时用使用一台 Mac Mini 和一台 PC 开发。在家里，常用的设备目前是这样的： <!--more-->

1. 一台 Windows 8 PC
2. 一台 Windows 7 Notebook
3. 一台 Windows 8 平板电脑
4. 一台 Android 平板电脑
5. 一部 Android 手机
6. 一部 iPhone 手机
7. 一部 iPod 设备

以前，对于我来说，必须使用 Windows 主要有这样几个考虑：

1. 网上银行；
2. QQ；
3. 网盘客户端；
4. Flash。

而现在，前三者都已经可以使用手机 App 替代了，何况我工作之外的时间已经不再使用QQ。而 Flash ？ [再见了][4] 。

另外，即使我的主 PC 不再是 Windows ，碰到必须在 Windows 下面进行的操作（例如Andoid刷机？），也可以借助 Notebook 来进行。Windows 8 平板也能起到一定作用。

看起来我似乎已经不需要 Windows 了。但由于主系统是 AMD 平台，安装黑苹果十分折腾，也不愿意再折腾原来折腾过的 [Arch Linux][6] ，于是就安装了省事的 Ubuntu。

下面记录一些我调整系统的过程。毕竟把系统调整到我的习惯，也是一件麻烦事。

# 1. 环境

## 1.1 shell

一直用的是 zsh。这个最简单了，安装 [oh-my-zsh][7] 即可，Linux/OS X/cygwin/MinGW 都通用。

## 1.2 服务管理器

[sysv-rc-conf][10] 这个最好用了。

# 2. 梯子

## 2.1 shadowsocks

以前在 Ubuntu 上搭建 shadowsocks 是作为服务端，这次则是作为客户端使用。shadowsocks 客户端自己就支持 daemon 模式，加上 `-d` 参数就可以了：

```shell
# 启动本地服务器(daemon模式)
sudo sslocal -s your_server_ip -p your_server_port -l your_local_port -k your_password -d start
# 停止本地服务器
sudo sslocal -s your_server_ip -p your_server_port -l your_local_port -k your_password -d stop
```

当然，也可以先创建一个配置文件 `sudo vim /etc/shadowsocks.json` ：


```json
{ 
"server":"your_server_ip", 
"server_port":your_server_port, 
"local_port":your_local_port, 
"password":"your_password", 
"timeout":300, 
"method":"aes-256-cfb", 
"fast_open":true 
} 
```

然后使用配置文件来启动，这就简单许多了：

```shell
sudo sslocal -c /etc/shadowsocks.json
```

## 2.2 supervisor

我更喜欢使用 [supervisor][8] 来控制 shadowsocks。先创建一个配置文件：

```shell
sudo vim /etc/supervisor/conf.d/shadowsocks.conf
```

内容如下：

```
[program:shadowsocks]
command=sslocal -c /etc/shadowsocks.json
autostart=true
startsecs=10
startretries=10
```

然后重载 supervisor ：

```shell
sudo supervisorctl reload
# Restarted supervisord
```
查看当前的状态，可以看到 shadowsocks 已经在运行了：
```shell
sudo supervisorctl status
# shadowsocks                      STARTING   
```
## 2.3 proxychains

如果要在命令行下也使用 shadowsocks ，那么可以借助 [proxychains][9] 。

proxychains 的系统配置文件位于 `/etc/proxychains.conf` ，为了方便修改，我选择创建一个自己的配置文件，这个配置文件在读取的时候优先于系统配置文件：

```shell
vim ~/.proxychains/proxychains.conf
```

内容如下（可以打开系统配置文件进行参考）：

```
strict_chain
proxy_dns 
remote_dns_subnet 224
tcp_read_time_out 15000
tcp_connect_time_out 8000
localnet 127.0.0.0/255.0.0.0
quiet_mode

[ProxyList]
socks5  127.0.0.1 your_local_port
```

然后做个测试：

```
proxychains wget twitter.com

ProxyChains-3.1 (http://proxychains.sf.net)
--2015-04-04 21:18:39--  http://twitter.com/
Resolving twitter.com (twitter.com)... 199.59.148.10
Connecting to twitter.com (twitter.com)|199.59.148.10|:80... connected.
HTTP request sent, awaiting response... 301 Moved Permanently
Location: https://twitter.com/ [following]
--2015-04-04 21:18:40--  https://twitter.com/
Connecting to twitter.com (twitter.com)|199.59.148.10|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 59703 (58K) [text/html]
Saving to: ‘index.html’

100%[============================================================>] 59,703       163KB/s   in 0.4s   

2015-04-04 21:18:42 (163 KB/s) - ‘index.html’ saved [59703/59703]
```

# 3. 按键绑定

（还没搞定，待补充）

# 4. 应用软件

[麒麟][11] 操作系统的生态圈开发了许多软件，在 Ubuntu 下直接可用。

- [快盘][12]
- [农历][13]

[1]: http://zengrong.net/?s=%E6%8A%9B%E5%BC%83windows
[2]: http://zengrong.net/post/tag/cocos2d-x
[3]: http://zengrong.net/post/1557.htm
[4]: http://zengrong.net/post/tag/cygwin
[5]: http://zengrong.net/post/2231.htm
[6]: http://www.archlinux.org
[7]: https://github.com/robbyrussell/oh-my-zsh 
[8]: http://supervisord.org/
[9]: http://proxychains.sourceforge.net/
[10]: http://sysv-rc-conf.sourceforge.net/
[11]: http://www.ubuntu-china.cn/
[12]: http://www.ubuntukylin.com/applications/showimg.php?lang=cn&id=21
[13]: http://www.ubuntukylin.com/applications/showimg.php?lang=cn&id=17
